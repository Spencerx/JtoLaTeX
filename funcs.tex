NB. J functions which can be used in latex code

NB. Force conversion to latex entity.
toL =: k^:(-.@isnode)

NB. Takes a J function on strings and makes it latex-compatible.
asL =: 1 :'(<{.u`'''') on toL'
NB. J function on an array of boxed strings.
masL =: 1 :'(<{.u@:treetotex`'''') on <@<@:toL'

NB. Make a list infinite by appending '\ldots'.
inf =: (totree'\_ldots') ,~ toL

NB. Surround y with \begin{x} \end{x}
toLines =: <;._2@:(,&LF^:(LF~:{:))  :.  (;@:(,&LF&.>))
indent =: '  '&,&.>&.toLines
inenv =: '\begin{',[,'}',LF,indent@],'\end{',[,'}',LF"_

NB. Functions for handling lists and vectors.
listwith =: (texs [:>([,',',])&.>/)"1
rowvec =: '()'&listwith masL
tableform =: [:> [:([,(' \\',LF),])&.>/ ([,' & ',])&.>/"_1
totable =: tableform masL
mtypes =. ;:'matrix bmatrix Bmatrix pmatrix vmatrix Vmatrix'
".@:(],' =: (''',],''' inenv tableform) masL'"_)@> mtypes


NB. Physics (and other sciences, I suppose)
mean =: +/%#
stddev =: (+/%<:@#)&.:*:@:(-mean)
stderr =: stddev % %:@#

fmtExp =: ([,'\times10^',])&":"0
fmtDig =: k@:(":@[ 8!:0 ])
fmtPrec =: k@:(4 :0)"0 NB. precision fmtPrec number
  exp =. 10 <.@^. y
  if. 3>:|exp do. (":x->:exp) 8!:0 y
  else. ((":x) 8!:0 y%10^exp) fmtExp&.> exp end.
)
fmtU =: fmtPrec~ 1+1=(%<.&.(10&^.))
fmtWithU =: k@:(3 :0)"1
  ndigits =. >:-/ exp=. 10<.@^. 'N U'=.y
  if. 3>:|{:exp do. end.
)
Umean =: ]
